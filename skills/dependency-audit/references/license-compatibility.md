# ライセンス互換性リファレンス

## 主要ライセンスの分類

### Permissive（寛容）

商用利用可能、再配布自由、コピーレフト伝播なし:

| ライセンス | 条件 |
|-----------|------|
| **MIT** | 著作権表示の保持のみ |
| **BSD-2-Clause** | 著作権表示の保持のみ |
| **BSD-3-Clause** | 著作権表示 + 名前の無断使用禁止 |
| **Apache-2.0** | 著作権表示 + 変更点の明示 + 特許ライセンス付与 |
| **ISC** | MIT とほぼ同等 |

### Copyleft（コピーレフト）

派生物にも同じライセンスを適用する義務:

| ライセンス | 強さ | 伝播範囲 |
|-----------|------|---------|
| **GPL-3.0** | 強い | バイナリ配布時、ソース全体に伝播 |
| **GPL-2.0** | 強い | 同上 |
| **LGPL-3.0** | 弱い | ライブラリ部分のみ（動的リンクなら伝播しない） |
| **LGPL-2.1** | 弱い | 同上 |
| **AGPL-3.0** | 最も強い | ネットワーク経由のサービス提供でもソース公開義務 |
| **MPL-2.0** | ファイルレベル | 変更したファイルのみ公開義務 |

### その他

| ライセンス | 特徴 |
|-----------|------|
| **Unlicense** | パブリックドメイン相当 |
| **CC0-1.0** | パブリックドメイン |
| **CC-BY-4.0** | クリエイティブ・コモンズ（著作権表示必要） |
| **WTFPL** | 制約なし |

---

## 互換性マトリクス

### プロジェクトが MIT の場合

| 依存のライセンス | 互換性 | 対応 |
|----------------|--------|------|
| MIT | OK | そのまま使用可能 |
| BSD-2/3-Clause | OK | そのまま使用可能 |
| Apache-2.0 | OK | 特許条項に注意 |
| ISC | OK | そのまま使用可能 |
| MPL-2.0 | 注意 | 変更したファイルのソース公開が必要 |
| LGPL-2.1/3.0 | 注意 | 動的リンクなら OK、静的リンクは伝播 |
| GPL-2.0/3.0 | NG | プロジェクト全体に GPL が伝播 |
| AGPL-3.0 | NG | サービス提供でもソース公開義務 |

### プロジェクトが Apache-2.0 の場合

| 依存のライセンス | 互換性 |
|----------------|--------|
| MIT, BSD, ISC | OK |
| Apache-2.0 | OK |
| MPL-2.0 | 注意 |
| LGPL | 注意 |
| GPL-2.0 | NG（特許条項が非互換） |
| GPL-3.0 | 条件付きOK |

### プロジェクトがプロプライエタリ（商用）の場合

| 依存のライセンス | 互換性 |
|----------------|--------|
| MIT, BSD, ISC, Apache-2.0 | OK |
| MPL-2.0 | 注意（変更ファイルは公開必要） |
| LGPL | 注意（動的リンク推奨） |
| GPL, AGPL | NG |

---

## 互換性判定フロー

```
1. プロジェクトのライセンスを確認
   ↓
2. 依存パッケージのライセンスを一覧化
   ↓
3. Permissive ライセンスのみか？
   ├── Yes → 問題なし
   └── No → 次へ
   ↓
4. Copyleft ライセンスがあるか？
   ├── GPL/AGPL → プロジェクトライセンスと互換性を確認
   │   ├── 互換性あり → 条件を遵守して使用
   │   └── 互換性なし → 代替パッケージを検討
   ├── LGPL → 動的リンクで使用可能か確認
   └── MPL → ファイル単位の公開義務を確認
   ↓
5. ライセンス不明のパッケージがあるか？
   ├── Yes → npm view / GitHub で確認
   └── No → 完了
```

---

## よくある問題パターン

### GPL 混入

**症状**: dependencies に GPL ライセンスのパッケージが含まれている

**影響**: プロジェクト全体に GPL が伝播する可能性

**対応**:
1. 代替パッケージを検索（npmで同機能 + MIT/BSD を探す）
2. デュアルライセンスかを確認（MIT OR GPL-2.0 なら MIT を選択可能）
3. devDependencies のみなら影響小（配布物に含まれない場合）

### デュアルライセンス

**症状**: `(MIT OR GPL-2.0)` のように複数ライセンスが指定

**対応**: 自分に有利な方を選択可能。通常は Permissive な方（MIT）を選ぶ。

### ライセンス未明記

**症状**: license フィールドが `UNKNOWN` または未設定

**対応**:
1. `npm view {package} license` で確認
2. GitHub リポジトリの LICENSE ファイルを確認
3. 不明なまま → 使用を避ける（法的リスク）

### AGPL の特殊性

**症状**: SaaS として提供するアプリに AGPL パッケージが含まれている

**影響**: ネットワーク経由でサービスを提供する場合もソースコード公開義務

**対応**: AGPL パッケージは商用 SaaS では避ける

---

## 対応方針

### 代替パッケージの探し方

1. npm で同機能のパッケージを検索
2. フィルタリング: ライセンスが Permissive
3. ダウンロード数・メンテナンス状況を確認

### ライセンス表示の義務

多くの Permissive ライセンスは著作権表示の保持を要求:

```
// THIRD_PARTY_LICENSES.txt に記載
// または bundled output に自動含有（webpack-license-plugin 等）
```

```bash
# ライセンス一覧の自動生成
npx license-checker --production --csv > THIRD_PARTY_LICENSES.csv
```
